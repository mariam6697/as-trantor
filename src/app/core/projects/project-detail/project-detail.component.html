<div class="as-header">
  <h1 *ngIf="!project || !project.name">Detalle del proyecto</h1>
  <h1 *ngIf="project && project.name">{{ project.name }}</h1>
  <div>
    <mat-slide-toggle
      labelPosition="before"
      color="primary"
      [disabled]="loading"
      [checked]="editable"
      (change)="editable = !editable"
    >
      <h3 style="margin-bottom: 0">Editar</h3></mat-slide-toggle
    >
  </div>
</div>

<mat-card
  *ngIf="loading"
  class="mat-elevation-z0"
  style="
    min-height: 70vh;
    min-width: 300px;
    display: flex;
    justify-content: center;
    align-items: center;
  "
>
  <mat-spinner *ngIf="loading" diameter="50"></mat-spinner>
</mat-card>

<mat-card
  *ngIf="!loading && project"
  class="mat-elevation-z0"
  style="min-height: 70vh; min-width: 300px"
>
  <div class="responsive-row">
    <div class="half-row">
      <h2>Detalles principales</h2>
      <form [formGroup]="projectForm" (ngSubmit)="save()">
        <mat-form-field appearance="outline" style="width: 100%">
          <mat-label>Nombre</mat-label>
          <input matInput formControlName="name" />
        </mat-form-field>

        <mat-form-field appearance="outline" style="width: 100%">
          <mat-label>Año</mat-label>
          <select matNativeControl matInput formControlName="year" required>
            <option *ngFor="let year of yearOptions" [value]="year">
              {{ year }}
            </option>
          </select>
        </mat-form-field>

        <mat-form-field appearance="outline" style="width: 100%">
          <mat-label>Semestre</mat-label>
          <select matNativeControl matInput formControlName="semester" required>
            <option value="1">Primero</option>
            <option value="2">Segundo</option>
          </select>
        </mat-form-field>

        <mat-form-field appearance="outline" style="width: 100%">
          <mat-label>Descripción</mat-label>
          <textarea
            matInput
            cdkTextareaAutosize
            cdkAutosizeMinRows="2"
            cdkAutosizeMaxRows="5"
            formControlName="description"
          ></textarea>
        </mat-form-field>

        <button mat-flat-button color="primary" type="submit" [disabled]="!editable">Guardar</button>
      </form>
    </div>
    <div class="half-row">
      <h2>Vista previa descripción</h2>
      <div class="md-container">
        <markdown emoji [data]="projectForm.get('description')!.value">
        </markdown>
      </div>
    </div>
  </div>
</mat-card>
